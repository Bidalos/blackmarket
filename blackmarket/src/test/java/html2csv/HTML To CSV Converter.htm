<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<!-- Copyright 2014 ConvertCsv.com -->
<meta name="description" content="Convert HTML to CSV">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>HTML To CSV Converter</title>
<script src="HTML%20To%20CSV%20Converter_files/ca-pub-2674404638298268.js" type="text/javascript" async=""></script><script src="HTML%20To%20CSV%20Converter_files/underscore-min.js"></script>
<script src="HTML%20To%20CSV%20Converter_files/blob.js"></script>
<script src="HTML%20To%20CSV%20Converter_files/filesaver.js"></script>
<script src="HTML%20To%20CSV%20Converter_files/json2.js"></script>
<script src="HTML%20To%20CSV%20Converter_files/strsup.js"></script>
<script src="HTML%20To%20CSV%20Converter_files/localread.js"></script>
<script src="HTML%20To%20CSV%20Converter_files/csvparse.js"></script>
<script src="HTML%20To%20CSV%20Converter_files/csvsup.js"></script>
<link href="HTML%20To%20CSV%20Converter_files/layout3col.css" rel="stylesheet" type="text/css">

<script type="text/javascript">
function assignText(s) {
   document.getElementById('txt1').value = s;
   document.getElementById('btnRun').click();
}
function runit() {
    var delimiter = radiovalue(document.getElementById('frm1').outsep);
    var noMultiLines = document.getElementById('chkNoBreaks').checked;
    if (delimiter == "o") delimiter = document.getElementById("outSepOtherVal").value;
    var whichTable = document.getElementById('selTabNum').value;
    whichTable = whichTable || "0";
    var bQuotes = (document.getElementById('chkCsvQuotes')).checked;
    var removeTags = (document.getElementById('chkRemoveTags')).checked;
    var html=document.getElementById('divHtml');
    html.innerHTML=document.getElementById('txt1').value.replace(/<script/gmi,"<xxxxx");
  //html.innerHTML=document.getElementById('txt1').value.replace(/<script[^>]*>([\\S\\s]*?)<\/script>/img,""); // to do
    var s="";
    var cells;
    var value;
    var tbl = html.getElementsByTagName('table');
    var cnt=tbl.length;
    var re = new RegExp("<\/?\\w+((\\s+\\w+(\\s*=\\s*(?:\".*?\"|'.*?'|[^'\">\\s]+))?)+\\s*|\\s*)\/?>",'igm');

    for(var j=0;j<tbl.length;j++) {
        if( (""+(j+1)) != whichTable && whichTable!="0") continue;
        rows=tbl[j].getElementsByTagName('tr');
        for(var k=0;k<rows.length;k++) {
            if ('querySelectorAll' in document) {
               cells=rows[k].querySelectorAll('td,th');
            } else {
               cells=rows[k].getElementsByTagName('td');
               if(!cells || cells.length==0) {
                  cells=rows[k].getElementsByTagName('th');
               }
            }

            for(var n=0;n<cells.length;n++) {
				
				/* http://pathofexile.gamepedia.com Item Type Icons */
				var anchorTag = cells[n].getElementsByTagName("a");
				if(anchorTag.length > 0) value = anchorTag[0].getAttribute("title");
			    else value=cells[n].innerHTML;
				
               if(value==null)value="";else value+="";
               value = value.replace(/\r\n|\r|\n/gmi,' ');
               if(noMultiLines) value = value.replace(/\n|<br>|<br\/>|<br \/>/gmi,' ');
               else value = value.replace(/\n|<br>|<br\/>|<br \/>/gmi,'\n');
			   
			       /* http://pathofexile.gamepedia.com Parse Green Check Icons */
			   if(value.indexOf("alt=\"yes\"") > -1)
			     value = "yes";
			   
               if (removeTags) value=value.replace(re,''); 
               value=_.unescape(value);
               value=value.replace(/&nbsp;/gmi," ");
               value=value.trim();
               if(bQuotes) {
                  s += '"' + value.replace(/"/gmi, '""') + '"' + delimiter; 
               }
               else {
                  s+=value.toCsv(delimiter,'"') + delimiter; 
               } 
           }
           s=s.slice(0, delimiter.length*-1); // remove last delimiter
           s += "\n"; 
        } 
    }
    document.getElementById('txta').value = s; 
    if(cnt<1 && document.getElementById('txt1').value.trim() != "") {
       window.alert('No TABLE tag found in HTML. Please check your input.');
    }
    s = "<select id=\"selTabNum\"  onchange=\"document.getElementById('btnRun').click()\">";
    s += "<option value=0>-All-</option>"
    for(j=0;j<cnt;j++) {
       s+= "<option value=\"" + (j+1) + "\" ";
       if( (j+1)==whichTable) s+=" selected";
       s+= ">" + getOrdinal(j+1) + "</option>";
    }
    s+="</select>";
    document.getElementById("spanTabNum").innerHTML = s;
    document.getElementById('spanCount').innerHTML = "(Tables found: " + cnt + ")";
}

</script>
<style>
 table { border-collapse:collapse; }
 table,th, td { border: 1px solid black; }
</style>
</head> 
<body onload="document.getElementById('btnRun').click()">

<div class="heading">
<h1>Convert HTML Table To CSV - Customized for http://pathofexile.gamepedia.com</h1>
</div>
<div class="container">
<div class="leftnew">
    <b>CSV Conversions</b><br>
 
<script src="HTML%20To%20CSV%20Converter_files/csvlinks.js"></script><a href="http://www.convertcsv.com/csv-to-csv.htm">CSV To Delimited</a><br><a href="http://www.convertcsv.com/csv-to-flat-file.htm">CSV To Flat File</a><br><a href="http://www.convertcsv.com/csv-to-geojson.htm">CSV To GeoJSON</a><br><a href="http://www.convertcsv.com/csv-to-html.htm">CSV To HTML Table</a><br><a href="http://www.convertcsv.com/csv-to-json.htm">CSV To JSON</a><br><a href="http://www.convertcsv.com/csv-to-kml.htm">CSV To KML</a><br><a href="http://www.convertcsv.com/csv-to-multiline-data.htm">CSV To Multi-line Data</a><br><a href="http://www.convertcsv.com/csv-to-sql.htm">CSV To SQL</a><br><a href="http://www.convertcsv.com/csv-to-xml.htm">CSV To XML</a><br><a href="http://www.convertcsv.com/csv-to-yaml.htm">CSV To YAML</a><br><a href="http://www.convertcsv.com/fixed-width-to-csv.htm">Flat File to CSV</a><br><a href="http://www.convertcsv.com/geojson-to-csv.htm">GeoJSON To CSV</a><br><a href="http://www.convertcsv.com/html-table-to-csv.htm">HTML Table To CSV</a><br><a href="http://www.convertcsv.com/json-to-csv.htm">JSON To CSV</a><br><a href="http://www.convertcsv.com/kml-to-csv.htm">KML To CSV</a><br><a href="http://www.convertcsv.com/sql-to-csv.htm">SQL To CSV</a><br><a href="http://www.convertcsv.com/pivot-csv.htm">Pivot CSV</a><br><a href="http://www.convertcsv.com/transpose-csv.htm">Transpose CSV</a><br><a href="http://www.convertcsv.com/xml-to-csv.htm">XML To CSV</a><br><a href="http://www.convertcsv.com/yaml-to-csv.htm">YAML To CSV</a><br><b>Tools</b><br><a href="http://www.convertcsv.com/csv-escape-tool.htm">CSV Escape Tool</a><br><a href="http://www.convertcsv.com/csv-to-template-output.htm">CSV Template Engine</a><br><a href="http://www.convertcsv.com/csv-viewer-editor.htm">CSV Editor</a><br><a href="http://www.convertcsv.com/generate-test-data.htm">Generate Test Data</a><br><a href="http://www.convertcsv.com/">CSV Home</a><br>
<br>
</div>
<div class="rightnew">
<!-- advertising goes here -->
    <br>
<br>
<br>

</div>
<div class="middlenew">
    <p>Use this tool to convert HTML tables into CSV (Comma Separated Values). 
        <br>Your HTML input should contain at least one <b>TABLE</b> tag. 
        If your HTML contains more than one TABLE tag, you can choose which table
        to convert by changing the "Which Table" selection. 
        <br>All tables will be converted by default into 1 CSV file.
        <br>Please paste your HTML in the box below or use the Browse button.
        <br>You can now load an external web page! See <b>Enter an URL</b>
        <br>NEW - You can now convert ALL tables into one CSV file.
        <br>See also <a href="http://www.convertcsv.com/csv-to-html.htm">CSV to HTML Table</a>
    </p>


<form id="frm1" name="frm1">
   <br><b>Choose HTML file here</b> 
    <input id="f1" onchange="loadTextFile(this,assignText)" title="Choose a local HTML file" type="file">
   <br><b>or Enter an URL</b> <input size="40" name="url" id="url" title="Enter the URL of a web page" type="text"> 
         <input id="btnUrl" value="Load URL" title="Load CSV via URL" onclick="loadURL(document.getElementById('url').value)" type="button">
   <br><b>or paste into Text Box below</b><br>
 &nbsp;<input value="Clear Input" onclick="window.location.reload(true)" type="button">
    &nbsp; <input value="Example" title="Load and run example" onclick="document.getElementById('url').value='http://www.tournamentmaps.com/florida-tennis-colleges.htm';document.getElementById('btnUrl').click()" type="button"><br>
	
	<textarea class="xxxxlined" rows="10" cols="80" id="txt1" placeholder="HTML" onchange="runit()" wrap="off"></textarea>
	

<br>

<fieldset><legend>Output Options</legend>
    Output Field Separator: 
     <label><input name="outsep" id="outSepComma" value="," checked="checked" type="radio"> Comma-,</label> &nbsp;    
     <label><input name="outsep" id="outSepSemicolon" value=";" type="radio"> Semi-colon-;</label> &nbsp;
     <label><input name="outsep" id="outSepSemicolon" value=":" type="radio"> Colon-:</label> &nbsp;
     <label><input name="outsep" id="outSepPipe" value="|" type="radio"> Bar-|</label> &nbsp;
     <label><input name="outsep" id="outSepTab" value=" " onclick="this.value='\t'" type="radio"> Tab</label> &nbsp;
     <label><input name="outsep" id="outSepOther" value="o" type="radio"> Other-Choose</label>
     <label><input size="2" id="outSepOtherVal" value="@" type="text"></label>
    <br>
    <label><input id="chkCsvQuotes" type="checkbox"> Force Wrap values in double quotes</label>
    <br>
    <label><input id="chkNoBreaks" value="Y" checked="checked" type="checkbox"> Change &lt;BR&gt; tags to space in CSV</label>
      (Use this to remove line breaks in field values)
    <br>
    <label><input id="chkRemoveTags" value="Y" checked="checked" type="checkbox"> Remove HTML tags in CSV</label>
      (Use this to prevent seeing HTML tags in your output)
  </fieldset>
<br>
<input id="btnRun" value="Convert HTML To CSV" title="Convert HTML Table To CSV" onclick="runit()" type="button">
    &nbsp; 
    <label>Which table? <span id="spanTabNum"><select id="selTabNum" onchange="document.getElementById('btnRun').click()"><option selected="selected" value="0">-All-</option><option value="1">1st</option></select></span></label>
    <span id="spanCount">(Tables found: 1)</span>
   </form>
   <hr>
</div>
      <center>
    <label><input type="text" size="15" id="fn" value="convertcsv" title="Enter filename without extension" />.csv</label>
    <label><input type="button" value="Save to Disk" onclick="saveFile(document.getElementById('txta').value,'csv')" /></label>
        <label title="End-of-Line">EOL: <select id="eol" title="CRLF=Windows,LF=Unix/Linux/New Apple/Android"><option value="">CRLF</option><option value="LF">LF</option></select></label><br/>
   <textarea id="txta" rows="15" cols="100" wrap="off" placeholder="Output Results"></textarea></center>
</div>
<div id="divHtml" style="display:none; visibility: hidden; height: 5px"></div>

</body></html>